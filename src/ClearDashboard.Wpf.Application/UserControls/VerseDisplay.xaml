<UserControl
    x:Class="ClearDashboard.Wpf.Application.UserControls.VerseDisplay"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:converters="clr-namespace:ClearDashboard.Wpf.Application.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:enhancedView="clr-namespace:ClearDashboard.Wpf.Application.ViewModels.EnhancedView;assembly=ClearDashboard.Wpf.Application.Abstractions"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:userControls="clr-namespace:ClearDashboard.Wpf.Application.UserControls"
    d:DesignHeight="450"
    d:DesignWidth="800"
    mc:Ignorable="d">

    <UserControl.Resources>
        <converters:BoolFlowDirectionConverter x:Key="BoolFlowDirectionConverter" />

        <DataTemplate x:Key="SourceTokenDisplay">
            <userControls:TokenDisplay
                HorizontalAlignment="Left"
                Copy="OnCopy"
                DataContext="{Binding}"
                FilterPins="OnFilterPins"
                HighlightedTokenBackground="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=HighlightedTokenBackground}"
                HorizontalSpacing="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=HorizontalSpacing}"
                NoteCreate="OnNoteCreate"
                NoteIndicatorColor="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=NoteIndicatorColor}"
                NoteIndicatorHeight="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=NoteIndicatorHeight}"
                NoteIndicatorLeftButtonDown="OnNoteLeftButtonDown"
                NoteIndicatorLeftButtonUp="OnNoteLeftButtonUp"
                NoteIndicatorMouseEnter="OnNoteMouseEnter"
                NoteIndicatorMouseLeave="OnNoteMouseLeave"
                NoteIndicatorMouseWheel="OnNoteMouseWheel"
                NoteIndicatorRightButtonDown="OnNoteRightButtonDown"
                NoteIndicatorRightButtonUp="OnNoteRightButtonUp"
                Orientation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Orientation}"
                SelectedTokenBackground="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SelectedTokenBackground}"
                ShowNoteIndicator="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=ShowNoteIndicators}"
                ShowTranslation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=ShowTranslations}"
                TokenClicked="OnTokenClicked"
                TokenCreateAlignment="OnTokenCreateAlignment"
                TokenDeleteAlignment="OnTokenDeleteAlignment"
                TokenDoubleClicked="OnTokenDoubleClicked"
                TokenFlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsSourceRtl), Converter={StaticResource BoolFlowDirectionConverter}}"
                TokenFontFamily="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SourceFontFamily}"
                TokenFontSize="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SourceFontSize}"
                TokenFontStyle="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SourceFontStyle}"
                TokenFontWeight="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SourceFontWeight}"
                TokenJoin="OnTokenJoin"
                TokenJoinLanguagePair="OnTokenJoinLanguagePair"
                TokenLeftButtonDown="OnTokenLeftButtonDown"
                TokenLeftButtonUp="OnTokenLeftButtonUp"
                TokenMouseEnter="OnTokenMouseEnter"
                TokenMouseLeave="OnTokenMouseLeave"
                TokenMouseWheel="OnTokenMouseWheel"
                TokenRightButtonDown="OnTokenRightButtonDown"
                TokenRightButtonUp="OnTokenRightButtonUp"
                TokenUnjoin="OnTokenUnjoin"
                TokenVerticalSpacing="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TokenVerticalSpacing}"
                TranslateQuick="OnTranslateQuick"
                TranslationAlignment="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationAlignment}"
                TranslationClicked="OnTranslationClicked"
                TranslationDoubleClicked="OnTranslationDoubleClicked"
                TranslationFlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFlowDirection}"
                TranslationFontFamily="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontFamily}"
                TranslationFontSize="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontSize}"
                TranslationFontStyle="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontStyle}"
                TranslationFontWeight="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontWeight}"
                TranslationLeftButtonDown="OnTranslationLeftButtonDown"
                TranslationLeftButtonUp="OnTranslationLeftButtonUp"
                TranslationMouseEnter="OnTranslationMouseEnter"
                TranslationMouseLeave="OnTranslationMouseLeave"
                TranslationMouseWheel="OnTranslationMouseWheel"
                TranslationRightButtonDown="OnTranslationRightButtonDown"
                TranslationRightButtonUp="OnTranslationRightButtonUp"
                TranslationVerticalSpacing="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationVerticalSpacing}">
                <userControls:TokenDisplay.CommandBindings>
                    <CommandBinding Command="Copy" Executed="OnCopy" />
                </userControls:TokenDisplay.CommandBindings>

                <userControls:TokenDisplay.InputBindings>
                    <KeyBinding
                        Key="C"
                        Command="Copy"
                        Modifiers="Control" />
                </userControls:TokenDisplay.InputBindings>
            </userControls:TokenDisplay>
        </DataTemplate>
        <DataTemplate x:Key="TargetTokenDisplay">
            <userControls:TokenDisplay
                HorizontalAlignment="Left"
                Copy="OnCopy"
                DataContext="{Binding}"
                FilterPins="OnFilterPins"
                HighlightedTokenBackground="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=HighlightedTokenBackground}"
                HorizontalSpacing="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=HorizontalSpacing}"
                NoteCreate="OnNoteCreate"
                NoteIndicatorColor="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=NoteIndicatorColor}"
                NoteIndicatorHeight="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=NoteIndicatorHeight}"
                NoteIndicatorLeftButtonDown="OnNoteLeftButtonDown"
                NoteIndicatorLeftButtonUp="OnNoteLeftButtonUp"
                NoteIndicatorMouseEnter="OnNoteMouseEnter"
                NoteIndicatorMouseLeave="OnNoteMouseLeave"
                NoteIndicatorMouseWheel="OnNoteMouseWheel"
                NoteIndicatorRightButtonDown="OnNoteRightButtonDown"
                NoteIndicatorRightButtonUp="OnNoteRightButtonUp"
                Orientation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Orientation}"
                SelectedTokenBackground="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SelectedTokenBackground}"
                ShowNoteIndicator="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=ShowNoteIndicators}"
                ShowTranslation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=ShowTranslations}"
                TokenClicked="OnTokenClicked"
                TokenCreateAlignment="OnTokenCreateAlignment"
                TokenDeleteAlignment="OnTokenDeleteAlignment"
                TokenDoubleClicked="OnTokenDoubleClicked"
                TokenFlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsTargetRtl), Converter={StaticResource BoolFlowDirectionConverter}}"
                TokenFontFamily="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetFontFamily}"
                TokenFontSize="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetFontSize}"
                TokenFontStyle="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetFontStyle}"
                TokenFontWeight="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetFontWeight}"
                TokenJoin="OnTokenJoin"
                TokenLeftButtonDown="OnTokenLeftButtonDown"
                TokenLeftButtonUp="OnTokenLeftButtonUp"
                TokenMouseEnter="OnTokenMouseEnter"
                TokenMouseLeave="OnTokenMouseLeave"
                TokenMouseWheel="OnTokenMouseWheel"
                TokenRightButtonDown="OnTokenRightButtonDown"
                TokenRightButtonUp="OnTokenRightButtonUp"
                TokenUnjoin="OnTokenUnjoin"
                TokenVerticalSpacing="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TokenVerticalSpacing}"
                TranslateQuick="OnTranslateQuick"
                TranslationAlignment="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationAlignment}"
                TranslationClicked="OnTranslationClicked"
                TranslationDoubleClicked="OnTranslationDoubleClicked"
                TranslationFlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFlowDirection}"
                TranslationFontFamily="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontFamily}"
                TranslationFontSize="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontSize}"
                TranslationFontStyle="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontStyle}"
                TranslationFontWeight="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationFontWeight}"
                TranslationLeftButtonDown="OnTranslationLeftButtonDown"
                TranslationLeftButtonUp="OnTranslationLeftButtonUp"
                TranslationMouseEnter="OnTranslationMouseEnter"
                TranslationMouseLeave="OnTranslationMouseLeave"
                TranslationMouseWheel="OnTranslationMouseWheel"
                TranslationRightButtonDown="OnTranslationRightButtonDown"
                TranslationRightButtonUp="OnTranslationRightButtonUp"
                TranslationVerticalSpacing="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TranslationVerticalSpacing}">
                <userControls:TokenDisplay.CommandBindings>
                    <CommandBinding Command="Copy" Executed="OnCopy" />
                </userControls:TokenDisplay.CommandBindings>

                <userControls:TokenDisplay.InputBindings>
                    <KeyBinding
                        Key="C"
                        Command="Copy"
                        Modifiers="Control" />
                </userControls:TokenDisplay.InputBindings>
            </userControls:TokenDisplay>
        </DataTemplate>
        <ItemsPanelTemplate x:Key="SourceWrapPanelTemplate">
            <WrapPanel FlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsSourceRtl), Converter={StaticResource BoolFlowDirectionConverter}}" Orientation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Orientation}" />
        </ItemsPanelTemplate>
        <ItemsPanelTemplate x:Key="TargetWrapPanelTemplate">
            <WrapPanel FlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsTargetRtl), Converter={StaticResource BoolFlowDirectionConverter}}" Orientation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Orientation}" />
        </ItemsPanelTemplate>
        <ItemsPanelTemplate x:Key="SourceStackPanelTemplate">
            <StackPanel
                HorizontalAlignment="Left"
                FlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsSourceRtl), Converter={StaticResource BoolFlowDirectionConverter}}"
                Orientation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Orientation}" />
        </ItemsPanelTemplate>
        <ItemsPanelTemplate x:Key="TargetStackPanelTemplate">
            <StackPanel
                HorizontalAlignment="Left"
                FlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsSourceRtl), Converter={StaticResource BoolFlowDirectionConverter}}"
                Orientation="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Orientation}" />
        </ItemsPanelTemplate>
    </UserControl.Resources>

    <StackPanel Orientation="Vertical">
        <TextBlock
            Margin="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TitleMargin}"
            Padding="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TitlePadding}"
            HorizontalAlignment="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TitleHorizontalAlignment}"
            FlowDirection="LeftToRight"
            FontSize="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TitleFontSize}"
            Text="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=Title}"
            Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TitleVisibility}" />
        <Border
            Margin="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseMargin}"
            Padding="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VersePadding}"
            Background="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseBackground}"
            BorderBrush="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseBorderBrush}"
            BorderThickness="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseBorderThickness}">
            <ItemsControl
                FlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsSourceRtl), Converter={StaticResource BoolFlowDirectionConverter}}"
                ItemTemplate="{StaticResource SourceTokenDisplay}"
                ItemsPanel="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SourceItemsPanelTemplate}"
                ItemsSource="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=SourceTokens}" />
        </Border>
        <Border
            Margin="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseMargin}"
            Padding="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VersePadding}"
            Background="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseBackground}"
            BorderBrush="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseBorderBrush}"
            BorderThickness="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=VerseBorderThickness}"
            Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetVisibility}">
            <ItemsControl
                FlowDirection="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=DataContext.(enhancedView:VerseDisplayViewModel.IsTargetRtl), Converter={StaticResource BoolFlowDirectionConverter}}"
                ItemTemplate="{StaticResource TargetTokenDisplay}"
                ItemsPanel="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetItemsPanelTemplate}"
                ItemsSource="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetTokens}"
                Visibility="{Binding RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, Path=TargetVisibility}" />
        </Border>
    </StackPanel>
</UserControl>
